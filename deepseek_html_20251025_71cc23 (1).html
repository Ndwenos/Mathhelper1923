<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro Games Collection</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🎮</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #4ecdc4;
            --secondary-color: #ff6b6b;
            --background-color: #1a1a2e;
            --background-gradient: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            --card-bg: rgba(255, 255, 255, 0.1);
            --text-color: #fff;
            --accent-color: #45b7d1;
            --footer-text: #b8b8b8;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--background-gradient);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
            background: var(--card-bg);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 3.5rem;
            background: linear-gradient(45deg, var(--secondary-color), var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(78, 205, 196, 0.3);
        }

        .header p {
            font-size: 1.2rem;
            color: var(--text-color);
            margin-bottom: 20px;
            opacity: 0.8;
        }

        .game-counter {
            background: var(--card-bg);
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            font-weight: bold;
            color: var(--primary-color);
            border: 1px solid rgba(78, 205, 196, 0.3);
        }

        .theme-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
        }

        .theme-btn {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-color);
            padding: 10px 15px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .theme-btn:hover {
            background: var(--primary-color);
            color: var(--background-color);
            transform: translateY(-2px);
        }

        .theme-options {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--card-bg);
            border-radius: 15px;
            padding: 10px;
            margin-top: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-width: 180px;
            max-height: 400px;
            overflow-y: auto;
        }

        .theme-options.active {
            display: block;
        }

        .theme-option {
            padding: 8px 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 5px;
            color: var(--text-color);
        }

        .theme-option:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .theme-option:last-child {
            margin-bottom: 0;
        }

        .search-container {
            margin-bottom: 30px;
            text-align: center;
        }

        .search-box {
            width: 100%;
            max-width: 500px;
            padding: 15px 25px;
            border: none;
            border-radius: 50px;
            background: var(--card-bg);
            color: var(--text-color);
            font-size: 1.1rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--primary-color);
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.3);
        }

        .search-box::placeholder {
            color: #b8b8b8;
        }

        .random-picker {
            text-align: center;
            margin-bottom: 30px;
        }

        .random-btn {
            background: var(--secondary-color);
            border: none;
            color: #fff;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        .random-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
        }

        .random-result {
            margin-top: 20px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 15px;
            display: none;
        }

        .random-result.active {
            display: block;
        }

        .random-game {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .category-filter {
            text-align: center;
            margin-bottom: 30px;
        }

        .category-btn {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-color);
            padding: 12px 24px;
            margin: 5px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 600;
        }

        .category-btn:hover, .category-btn.active {
            background: var(--primary-color);
            color: var(--background-color);
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .section {
            margin-bottom: 50px;
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .section-icon {
            font-size: 2rem;
            margin-right: 15px;
        }

        .section-title {
            font-size: 2rem;
            background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-counter {
            background: var(--card-bg);
            padding: 5px 15px;
            border-radius: 20px;
            margin-left: auto;
            font-size: 0.9rem;
            color: var(--primary-color);
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .game-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .game-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
            z-index: 2;
        }

        .game-card:hover::after {
            left: 100%;
        }

        .game-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(78, 205, 196, 0.5);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .game-card .game-button {
            text-decoration: none;
            color: var(--text-color);
            font-weight: 600;
            font-size: 1.1rem;
            display: block;
            transition: color 0.3s ease;
            position: relative;
            z-index: 3;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            padding: 10px 15px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 8px;
            backdrop-filter: blur(5px);
            border: none;
            cursor: pointer;
            width: 100%;
            height: 100%;
            background: transparent;
        }

        .game-card:hover .game-button {
            color: var(--primary-color);
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: var(--text-color);
            font-size: 1.2rem;
            grid-column: 1 / -1;
            opacity: 0.7;
        }

        .footer {
            text-align: center;
            padding: 30px 0;
            color: var(--footer-text);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 40px;
        }

        /* Visitor Counter Styles */
        .visitor-counter {
            background: var(--card-bg);
            padding: 15px 25px;
            border-radius: 15px;
            margin: 20px auto;
            max-width: 600px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .visitor-counter h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
            font-size: 1.5rem;
        }

        .counter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .counter-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 10px;
        }

        .counter-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--secondary-color);
        }

        .counter-label {
            font-size: 0.9rem;
            color: var(--text-color);
            margin-top: 5px;
            opacity: 0.7;
        }

        /* Suggestions Section */
        .suggestions-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            margin-top: 40px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .suggestions-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }

        .suggestions-input {
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.2);
            color: var(--text-color);
            font-size: 1rem;
            resize: vertical;
            min-height: 100px;
        }

        .suggestions-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .suggestions-submit {
            background: var(--primary-color);
            color: var(--background-color);
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            align-self: flex-start;
        }

        .suggestions-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .suggestions-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .suggestion-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            border-left: 4px solid var(--primary-color);
        }

        .suggestion-text {
            margin-bottom: 15px;
            font-size: 1.1rem;
            line-height: 1.5;
            color: var(--text-color);
        }

        .suggestion-meta {
            display: flex;
            justify-content: space-between;
            color: var(--text-color);
            font-size: 0.9rem;
            margin-bottom: 15px;
            opacity: 0.7;
        }

        .suggestion-reply {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .reply-form {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .reply-input {
            flex: 1;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.2);
            color: var(--text-color);
        }

        .reply-submit {
            background: var(--primary-color);
            color: var(--background-color);
            border: none;
            padding: 8px 16px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
        }

        .replies-list {
            margin-top: 15px;
            padding-left: 20px;
            border-left: 2px solid rgba(255, 255, 255, 0.1);
        }

        .reply-item {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: var(--text-color);
        }

        .reply-item:last-child {
            border-bottom: none;
        }

        /* Game Viewer Modal - Full Screen */
        .game-viewer-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .game-viewer-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .game-viewer-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .game-viewer-header {
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 10;
        }

        .game-viewer-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .game-viewer-close {
            background: var(--secondary-color);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .game-viewer-close:hover {
            transform: scale(1.1);
            background: #ff5252;
        }

        .game-viewer-content {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            position: relative;
            overflow: hidden;
        }

        .game-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: black;
        }

        .game-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 5;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .game-viewer-content:hover .game-controls {
            opacity: 1;
        }

        .control-btn {
            background: var(--primary-color);
            border: none;
            color: var(--background-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            transform: scale(1.1);
            background: var(--accent-color);
        }

        .game-notice {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 5;
            opacity: 0.9;
            max-width: 80%;
        }

        /* Fullscreen styles */
        .game-viewer-modal.fullscreen .game-viewer-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
        }

        .game-viewer-modal.fullscreen .game-viewer-content {
            padding-top: 70px; /* Account for header height */
        }

        /* Active Users Counter */
        .active-users {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--card-bg);
            padding: 10px 15px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-color);
        }

        .active-users::before {
            content: '';
            display: block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4CAF50;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Content Filter Warning */
        .filter-warning {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid rgba(255, 107, 107, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
            color: var(--text-color);
        }

        .filter-warning.active {
            display: block;
        }

        .warning-icon {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .games-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .counter-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .theme-selector {
                position: relative;
                top: 0;
                right: 0;
                text-align: center;
                margin-bottom: 20px;
            }
            
            .reply-form {
                flex-direction: column;
            }
            
            .active-users {
                position: relative;
                bottom: auto;
                left: auto;
                margin: 20px auto;
                max-width: 200px;
            }

            .game-controls {
                bottom: 10px;
                padding: 8px 15px;
            }
            
            .control-btn {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
            
            .game-notice {
                top: 10px;
                font-size: 0.9rem;
                padding: 8px 15px;
            }
            
            .game-viewer-close {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .game-card {
                padding: 20px;
            }
            
            .category-btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .counter-grid {
                grid-template-columns: 1fr;
            }
            
            .game-controls {
                gap: 10px;
            }
            
            .control-btn {
                width: 30px;
                height: 30px;
                font-size: 0.9rem;
            }
            
            .game-notice {
                font-size: 0.8rem;
                padding: 6px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="theme-selector">
            <button class="theme-btn" id="themeToggle">🎨 Change Theme</button>
            <div class="theme-options" id="themeOptions">
                <div class="theme-option" data-theme="default">Default Theme</div>
                <div class="theme-option" data-theme="nintendo-red">Nintendo Red</div>
                <div class="theme-option" data-theme="nintendo-blue">Nintendo Blue</div>
                <div class="theme-option" data-theme="gameboy">Game Boy Classic</div>
                <div class="theme-option" data-theme="dark-void">Dark Void</div>
                <div class="theme-option" data-theme="midnight">Midnight</div>
                <div class="theme-option" data-theme="sunshine">Sunshine</div>
                <div class="theme-option" data-theme="pastel-dream">Pastel Dream</div>
                <div class="theme-option" data-theme="sega-blue">Sega Blue</div>
                <div class="theme-option" data-theme="playstation-purple">PlayStation Purple</div>
                <div class="theme-option" data-theme="namco-yellow">Namco Yellow</div>
            </div>
        </div>

        <div class="header">
            <h1>🎮 Retro Games Collection</h1>
            <p>Retro games for when you're bored</p>
            <div class="game-counter" id="totalGamesCounter">Loading...</div>
        </div>

        <!-- Visitor Counter -->
        <div class="visitor-counter">
            <h3>📊 Visitor Statistics</h3>
            <div class="counter-grid">
                <div class="counter-item">
                    <div class="counter-value" id="dailyVisitors">0</div>
                    <div class="counter-label">Today</div>
                </div>
                <div class="counter-item">
                    <div class="counter-value" id="weeklyVisitors">0</div>
                    <div class="counter-label">This Week</div>
                </div>
                <div class="counter-item">
                    <div class="counter-value" id="monthlyVisitors">0</div>
                    <div class="counter-label">This Month</div>
                </div>
                <div class="counter-item">
                    <div class="counter-value" id="yearlyVisitors">0</div>
                    <div class="counter-label">This Year</div>
                </div>
            </div>
        </div>

        <div class="search-container">
            <input type="text" class="search-box" placeholder="Search all games..." id="searchInput">
        </div>

        <div class="random-picker">
            <button class="random-btn" id="randomGameBtn">🎲 Pick a Random Game</button>
            <div class="random-result" id="randomResult">
                <div class="random-game" id="randomGameName"></div>
                <button class="game-button" id="randomGamePlay">Play Now</button>
            </div>
        </div>

        <div class="category-filter">
            <button class="category-btn active" data-category="all">All Games</button>
            <button class="category-btn" data-category="nintendo">🎯 Nintendo</button>
            <button class="category-btn" data-category="sega">⚡ Sega</button>
            <button class="category-btn" data-category="capcom">🔥 Capcom</button>
            <button class="category-btn" data-category="namco">🌟 Namco</button>
            <button class="category-btn" data-category="other">🎲 Other</button>
            <button class="category-btn" data-category="suggestions">💡 Suggestions</button>
        </div>

        <!-- All Games Section -->
        <div class="section active" id="section-all">
            <div class="section-header">
                <span class="section-icon">🎮</span>
                <h2 class="section-title">All Retro Games</h2>
                <div class="section-counter" id="all-counter">Loading...</div>
            </div>
            <div class="games-grid" id="gamesGridAll"></div>
        </div>

        <!-- Nintendo Section -->
        <div class="section" id="section-nintendo">
            <div class="section-header">
                <span class="section-icon">🎯</span>
                <h2 class="section-title">Nintendo Games</h2>
                <div class="section-counter" id="nintendo-counter">Loading...</div>
            </div>
            <div class="games-grid" id="gamesGridNintendo"></div>
        </div>

        <!-- Sega Section -->
        <div class="section" id="section-sega">
            <div class="section-header">
                <span class="section-icon">⚡</span>
                <h2 class="section-title">Sega Games</h2>
                <div class="section-counter" id="sega-counter">Loading...</div>
            </div>
            <div class="games-grid" id="gamesGridSega"></div>
        </div>

        <!-- Capcom Section -->
        <div class="section" id="section-capcom">
            <div class="section-header">
                <span class="section-icon">🔥</span>
                <h2 class="section-title">Capcom Games</h2>
                <div class="section-counter" id="capcom-counter">Loading...</div>
            </div>
            <div class="games-grid" id="gamesGridCapcom"></div>
        </div>

        <!-- Namco Section -->
        <div class="section" id="section-namco">
            <div class="section-header">
                <span class="section-icon">🌟</span>
                <h2 class="section-title">Namco Games</h2>
                <div class="section-counter" id="namco-counter">Loading...</div>
            </div>
            <div class="games-grid" id="gamesGridNamco"></div>
        </div>

        <!-- Other Section -->
        <div class="section" id="section-other">
            <div class="section-header">
                <span class="section-icon">🎲</span>
                <h2 class="section-title">Other Games</h2>
                <div class="section-counter" id="other-counter">Loading...</div>
            </div>
            <div class="games-grid" id="gamesGridOther"></div>
        </div>

        <!-- Suggestions Section -->
        <div class="section" id="section-suggestions">
            <div class="section-header">
                <span class="section-icon">💡</span>
                <h2 class="section-title">Game Suggestions</h2>
                <div class="section-counter" id="suggestions-counter">Can't find anything huh?</div>
            </div>
            
            <div class="suggestions-section">
                <div class="filter-warning" id="filterWarning">
                    <div class="warning-icon">⚠️</div>
                    <p>Your content contains inappropriate language. Please keep suggestions respectful and on-topic.</p>
                </div>
                
                <h3>Suggest a Game</h3>
                <form class="suggestions-form" id="suggestionForm">
                    <textarea class="suggestions-input" placeholder="What game should we add to the collection?" required></textarea>
                    <button type="submit" class="suggestions-submit">Submit Suggestion</button>
                </form>
                
                <h3>Community Suggestions</h3>
                <div class="suggestions-list" id="suggestionsList">
                    <!-- Suggestions will be added here dynamically -->
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Yup this is the bottom</p>
        </div>

        <!-- Active Users Counter -->
        <div class="active-users">
            <span id="activeUsersCount">1</span> active user(s)
        </div>
    </div>

    <!-- Game Viewer Modal -->
    <div class="game-viewer-modal" id="gameViewerModal">
        <div class="game-viewer-container">
            <div class="game-viewer-header">
                <div class="game-viewer-title" id="gameViewerTitle">Game Title</div>
                <button class="game-viewer-close" id="gameViewerClose">✕</button>
            </div>
            <div class="game-viewer-content">
                <div class="game-notice">
                    <p>Press F11 for fullscreen | ESC to exit</p>
                </div>
                <div class="game-controls">
                    <button class="control-btn" id="fullscreenBtn" title="Toggle Fullscreen">⛶</button>
                    <button class="control-btn" id="reloadBtn" title="Reload Game">↻</button>
                    <button class="control-btn" id="muteBtn" title="Toggle Sound">🔇</button>
                </div>
                <iframe class="game-frame" id="gameFrame" src="" allowfullscreen></iframe>
            </div>
        </div>
    </div>

    <script>
        // Game data with categories
        const games = [
            // Nintendo Games
            { name: "1942", url: "https://archive.org/embed/arcade_1942", category: "nintendo" },
            { name: "1943: The Battle of Midway Mark II", url: "https://archive.org/embed/arcade_1943mii", category: "nintendo" },
            { name: "balloon boy", url: "https://archive.org/embed/balloon_gb", category: "nintendo" },
            { name: "diddy Kong Racing", url: "https://archive.org/embed/diddy_lite", category: "nintendo" },
            { name: "donkey Kong country", url: "https://archive.org/embed/dk_gba", category: "nintendo" },
            { name: "donkey Kong 3", url: "https://archive.org/embed/donkey-kong-3", category: "nintendo" },
            { name: "Donkey Kong land III", url: "https://archive.org/embed/dk3_gb", category: "nintendo" },
            { name: "donkey Kong original", url: "https://archive.org/embed/donkey-kong-original-edition-nes-rom", category: "nintendo" },
            { name: "Dr Mario", url: "https://archive.org/embed/dr-mario-usabeta-19900427", category: "nintendo" },
            { name: "excite bike", url: "https://archive.org/embed/excitebike-japan-usa", category: "nintendo" },
            { name: "game and watch gallery 2", url: "https://archive.org/embed/gamewatch2", category: "nintendo" },
            { name: "kirbys dream land", url: "https://archive.org/embed/kirby_gb_2", category: "nintendo" },
            { name: "Kirby's dream land 2", url: "https://archive.org/embed/kirby2", category: "nintendo" },
            { name: "kirbys adventure", url: "https://archive.org/embed/kirbys-adventure_1993", category: "nintendo" },
            { name: "Legends of Zelda links awakening", url: "https://archive.org/embed/the-legend-of-zelda-links-awakening-dx", category: "nintendo" },
            { name: "Metroid", url: "https://archive.org/embed/metroid_20240911_1811", category: "nintendo" },
            { name: "Metroid II", url: "https://archive.org/embed/metroid-ii-return-of-samus-usa", category: "nintendo" },
            { name: "pokemon-Blue", url: "https://archive.org/embed/pokemon-blue-version-gb", category: "nintendo" },
            { name: "pokemon-Crystal", url: "https://archive.org/embed/pokemon-crystal-version-gb", category: "nintendo" },
            { name: "pokemon-Emerald", url: "https://archive.org/embed/pokemon-Emerald-version-gb", category: "nintendo" },
            { name: "pokemon-Fire-red", url: "https://archive.org/embed/pokemon-fire-red-version_202308", category: "nintendo" },
            { name: "pokemon-Gold", url: "https://archive.org/embed/pokemon-gold-version-gb", category: "nintendo" },
            { name: "pokemon-leaf-green", url: "https://archive.org/embed/pokemon_leaf_green-version-u-v-1.1", category: "nintendo" },
            { name: "Pokemon pinball", url: "https://archive.org/embed/pokemon-pinball-gb", category: "nintendo" },
            { name: "Pokemon puzzle challenge", url: "https://archive.org/embed/pokemon-puzzle-challenge", category: "nintendo" },
            { name: "pokemon-Red", url: "https://archive.org/embed/pokemon-red-version", category: "nintendo" },
            { name: "pokemon-Ruby", url: "https://archive.org/embed/pokemon_ruby-version-u-v-1.1", category: "nintendo" },
            { name: "pokemon-Sapphire", url: "https://archive.org/embed/pokemon-sapphire-version-v1.1", category: "nintendo" },
            { name: "pokemon-Silver", url: "https://archive.org/embed/pokemon-silver-version", category: "nintendo" },
            { name: "pokemon-yellow", url: "https://archive.org/embed/pokemon-yellow-version-gb", category: "nintendo" },
            { name: "Pokemon chaos black", url: "https://archive.org/embed/pokemon-black-special-palace-edition-1-by-mb-hacks-red-hack-goomba-v2.2", category: "nintendo" },
            { name: "punch out", url: "https://archive.org/embed/punchout-1", category: "nintendo" },
            { name: "super Mario all stars", url: "https://archive.org/embed/super-mario-all-stars-snes", category: "nintendo" },
            { name: "super Mario 3", url: "https://archive.org/embed/super-mario-advance-4-super-mario-bros.-3-u-v-1.1-patched_202501", category: "nintendo" },
            { name: "super Mario bro's deluxe", url: "https://archive.org/embed/super-mario-bros.-deluxe-usa-europe", category: "nintendo" },
            { name: "super Mario classic", url: "https://archive.org/embed/smb_nes_2", category: "nintendo" },
            { name: "super Mario kart", url: "https://archive.org/embed/super-mario-kart-usa_202303", category: "nintendo" },
            { name: "super Mario land", url: "https://archive.org/embed/sml_gb_2", category: "nintendo" },
            { name: "super Mario land 2 6 golden coins", url: "https://archive.org/embed/super-mario-land-2-6-golden-coins-gb", category: "nintendo" },
            { name: "super Mario world", url: "https://archive.org/embed/super-mario-world-super-nintendo", category: "nintendo" },
            { name: "super punch USA", url: "https://archive.org/embed/super-punch-out-usa_202301", category: "nintendo" },
            { name: "Tetris & Dr Mario", url: "https://archive.org/embed/tetris-dr-mario-snes", category: "nintendo" },
            { name: "tetris attack", url: "https://archive.org/embed/title_screenshot", category: "nintendo" },
            { name: "wario land IIII", url: "https://archive.org/embed/wario_gba", category: "nintendo" },
            { name: "wario land II", url: "https://archive.org/embed/wario-land-ii-usa-europe-sgb-enhanced-gb-compatible", category: "nintendo" },
            { name: "wario land III", url: "https://archive.org/embed/wario-land-3-world-en-ja", category: "nintendo" },
            { name: "wario's woods", url: "https://archive.org/embed/warios-woods-nes", category: "nintendo" },
            { name: "timbers balloon pop", url: "https://archive.org/embed/TimbersBalloonPop", category: "nintendo" },
            { name: "HamHam heartbreak", url: "https://archive.org/embed/hamtaro_gba", category: "nintendo" },
            { name: "magical Tetris Challenge featuring Micky mouse", url: "https://archive.org/embed/psx_mtetrisc", category: "nintendo" },
            { name: "Disneys magical quest 3", url: "https://archive.org/embed/magical3_gba", category: "nintendo" },
            { name: "Goof Troop", url: "https://archive.org/embed/goof_snes_2", category: "nintendo" },
            { name: "toki Tori", url: "https://archive.org/embed/toki_gbc_2", category: "nintendo" },
            { name: "camp hyrule meteor shower", url: "https://archive.org/embed/chmeteorshower_flash", category: "nintendo" },
            { name: "Breath of fire III", url: "https://archive.org/embed/psx_bof3j", category: "nintendo" },
            { name: "Super Mario 64", url: "https://archive.org/embed/super-mario-64_n64", category: "nintendo" },
            { name: "Super Mario Advance 3 Yoshi's Island", url: "https://archive.org/embed/super-mario-advance-3-yoshis-island-europe-en-fr-de-es-it", category: "nintendo" },
            { name: "Tetris Attack", url: "https://archive.org/embed/tetris_attack_u", category: "nintendo" },
            { name: "The Legend of Zelda NES", url: "https://archive.org/embed/zelda_nes_2", category: "nintendo" },
            { name: "Game and Watch gallery 4", url: "https://archive.org/embed/gamewatch4", category: "nintendo" },
            { name: "Mike Tysons Punch it out", url: "https://archive.org/embed/mike-tysons-punch-out-japan-usa", category: "nintendo" },
            { name: "Kirby and the Amazing Mirror", url: "https://archive.org/embed/KirbyMirror", category: "nintendo" },
            { name: "Kirby Nightmare in Dreamland", url: "https://archive.org/embed/kirby_gba", category: "nintendo" },
            { name: "Mario VS Donkey Kong", url: "https://archive.org/embed/mariokong", category: "nintendo" },
            { name: "Donkey Kong Country", url: "https://archive.org/embed/dkc_snes_2", category: "nintendo" },
            { name: "Kirby Star Stacker", url: "https://archive.org/embed/kirbys-star-stacker-usa-sgb-enhanced_202303", category: "nintendo" },
            { name: "Kirbys Pinball Land", url: "https://archive.org/embed/kirbys-pinball-land-usa-europe-patched", category: "nintendo" },
            { name: "Kirbys Block Ball", url: "https://archive.org/embed/kirbys-block-ball-usa-sgb-enhanced", category: "nintendo" },
            { name: "Tetris", url: "https://archive.org/embed/tetris-nes", category: "nintendo" },
            { name: "Donkey Kong Country 2", url: "https://archive.org/embed/dk2_gba", category: "nintendo" },
            { name: "The Legend of Zelda Oracle of Seasons", url: "https://archive.org/embed/legend-of-zelda-the-oracle-of-seasons-usa", category: "nintendo" },

            // Sega Games
            { name: "sonic 1 the next level", url: "https://archive.org/embed/Sonic_1_The_Next_Level", category: "sega" },
            { name: "sonic 2", url: "https://archive.org/embed/Sonic_The_Hedgehog_2_World_Rev_A.md", category: "sega" },
            { name: "sonic back in time", url: "https://archive.org/embed/Sonic_the_hedgehog_Back_In_Time", category: "sega" },
            { name: "sonic genesis", url: "https://archive.org/embed/sonicgenesis_bin", category: "sega" },
            { name: "Champion ice hockey", url: "https://archive.org/embed/Champion_Ice_Hockey_1985_Sega_JP_en", category: "sega" },
            { name: "Exerion", url: "https://archive.org/embed/Exerion_1983_Sega", category: "sega" },
            { name: "Buck Rogers planet of zoom", url: "https://archive.org/embed/a2_Buck_Rogers_Planet_of_Zoom_1984_Sega_cr_Blade", category: "sega" },
            { name: "Congo Bongo", url: "https://archive.org/embed/a8b_Congo_Bongo_1983_Sega_US_k_file", category: "sega" },
            { name: "Dessert Breaker", url: "https://archive.org/embed/arcade_desertbr", category: "sega" },
            { name: "Holosseum", url: "https://archive.org/embed/arcade_holo", category: "sega" },
            { name: "Line of fire", url: "https://archive.org/embed/arcade_loffire", category: "sega" },
            { name: "Microman Battle Charge", url: "https://archive.org/embed/arcade_micrombc", category: "sega" },
            { name: "OutRunners", url: "https://archive.org/embed/arcade_orunners", category: "sega" },
            { name: "Passing shot", url: "https://archive.org/embed/arcade_passsht", category: "sega" },
            { name: "Quiz Rouka", url: "https://archive.org/embed/arcade_qrouka", category: "sega" },
            { name: "Rad Mobile", url: "https://archive.org/embed/arcade_radm", category: "sega" },
            { name: "Rail chase", url: "https://archive.org/embed/arcade_rchase2", category: "sega" },
            { name: "Slap shooters", url: "https://archive.org/embed/arcade_slapshtr", category: "sega" },
            { name: "Thunder blade", url: "https://archive.org/embed/arcade_thndrbld", category: "sega" },
            { name: "Garfield caught in the act", url: "https://archive.org/embed/garfield-caught-in-the-act-usa-europe_202407", category: "sega" },
            { name: "Dragon Crystal", url: "https://archive.org/embed/gg_Dragon_Crystal_1991_Sega", category: "sega" },
            { name: "Gamble panic", url: "https://archive.org/embed/gg_Gamble_Panic_1995SegaJP", category: "sega" },
            { name: "Sega mobile paper boy", url: "https://archive.org/embed/section1_3_graphic", category: "sega" },
            { name: "Golden Axe Rev 1", url: "https://archive.org/embed/sg_Golden_Axe_Rev_1_1989_Sega", category: "sega" },
            { name: "Space Harrier II", url: "https://archive.org/embed/sg_Space_Harrier_II_1988_Sega_JP_en", category: "sega" },
            { name: "World champion soccer II", url: "https://archive.org/embed/sg_World_Championship_Soccer_II_1994_Sega_US", category: "sega" },
            { name: "Sonics bonus game", url: "https://archive.org/embed/sonic-bonus-game", category: "sega" },
            { name: "Sonic the Hedgehog Chaos Crush", url: "https://archive.org/embed/sonic-the-hedgehog-chaos-crush_202503", category: "sega" },
            { name: "Sonic Mega Collection Flash", url: "https://archive.org/embed/top_megacole2bb", category: "sega" },
            { name: "Sega Outrun", url: "https://archive.org/embed/Outrun_DOS", category: "sega" },
            { name: "Burning Rival", url: "https://archive.org/embed/arcade_brival", category: "sega" },
            { name: "Columns", url: "https://archive.org/embed/arcade_columns", category: "sega" },
            { name: "E-Swat - Cyber Police", url: "https://archive.org/embed/arcade_eswat", category: "sega" },
            { name: "Fantasy zone", url: "https://archive.org/embed/arcade_fantzone", category: "sega" },
            { name: "Bio Hazard Battle", url: "https://archive.org/embed/arcade_mp_bio", category: "sega" },
            { name: "Virtua Athletics", url: "https://archive.org/embed/arcade_vathlete", category: "sega" },
            { name: "Winter Heat", url: "https://archive.org/embed/arcade_winterht", category: "sega" },
            { name: "Dr Robotnik's Mean Bean Machine", url: "https://archive.org/embed/bean_bin", category: "sega" },
            { name: "Chao Adventure", url: "https://archive.org/embed/chao-adventure-dos", category: "sega" },
            { name: "Aerial Assault", url: "https://archive.org/embed/gg_Aerial_Assault_Rev_1_1992Sega", category: "sega" },
            { name: "Buster fight", url: "https://archive.org/embed/gg_Buster_Fight_1994SegaJPen", category: "sega" },
            { name: "Crystal Warriors", url: "https://archive.org/embed/gg_Crystal_Warriors_1992_Sega", category: "sega" },
            { name: "Doraemon Nora no Suke no Yabou", url: "https://archive.org/embed/gg_GG_Doraemon_Nora_no_Suke_no_Yabou_1993SegaJP", category: "sega" },
            { name: "VR Troopers", url: "https://archive.org/embed/gg_VR_Troopers_1995_Sega", category: "sega" },
            { name: "Sega Smash Pack", url: "https://archive.org/embed/sega_gba", category: "sega" },
            { name: "Wrestle war", url: "https://archive.org/embed/sg_Wrestle_War_1991_Sega_EU-JP_en", category: "sega" },
            { name: "Sky Striker", url: "https://archive.org/embed/arcade_strkfgtr", category: "sega" },
            { name: "Sonic Advance", url: "https://archive.org/embed/Sonic_Advance_v0.001_S2_Hack", category: "sega" },
            { name: "Sonic Spinball", url: "https://archive.org/embed/sg_Sonic_the_Hedgehog_Spinball_1993_Sega_US", category: "sega" },
            { name: "Yamato", url: "https://archive.org/embed/Yamato_1983_Sega", category: "sega" },
            { name: "Zaxxon", url: "https://archive.org/embed/Zaxxon_1985_Sega", category: "sega" },
            { name: "Air rescue", url: "https://archive.org/embed/arcade_arescue", category: "sega" },

            // Capcom Games
            { name: "Alien vs Predator", url: "https://archive.org/embed/arcade_avsp", category: "capcom" },
            { name: "Captain Commando", url: "https://archive.org/embed/arcade_captcomm", category: "capcom" },
            { name: "Dungeons and Dragons", url: "https://archive.org/embed/arcade_ddtod", category: "capcom" },
            { name: "Final Fight", url: "https://archive.org/embed/arcade_ffight", category: "capcom" },
            { name: "Ghouls'n Ghosts", url: "https://archive.org/embed/arcade_ghouls", category: "capcom" },
            { name: "Mega Man", url: "https://archive.org/embed/arcade_megaman", category: "capcom" },
            { name: "Marvel vs Capcom", url: "https://archive.org/embed/arcade_mvsc", category: "capcom" },
            { name: "Resident Evil", url: "https://archive.org/embed/arcade_re2", category: "capcom" },
            { name: "Rival Schools", url: "https://archive.org/embed/arcade_rvschool", category: "capcom" },
            { name: "Street Fighter", url: "https://archive.org/embed/arcade_sf2", category: "capcom" },
            { name: "Mortal Kombat Advance", url: "https://archive.org/embed/mkadvance", category: "capcom" },

            // Namco Games
            { name: "Ms. Pacman", url: "https://archive.org/embed/mspacman_mame", category: "namco" },
            { name: "Boxy Boy", url: "https://archive.org/embed/arcade_boxyboy", category: "namco" },
            { name: "Dangerous seed Japan", url: "https://archive.org/embed/arcade_dangseed", category: "namco" },
            { name: "Final Lap", url: "https://archive.org/embed/arcade_finallap", category: "namco" },
            { name: "Mach breakers", url: "https://archive.org/embed/arcade_machbrkr", category: "namco" },
            { name: "Super world stadium 93", url: "https://archive.org/embed/arcade_sws93", category: "namco" },
            { name: "Super Xevious", url: "https://archive.org/embed/arcade_sxevious", category: "namco" },
            { name: "Thunder Ceptor", url: "https://archive.org/embed/arcade_tceptor", category: "namco" },
            { name: "Gear Stadium", url: "https://archive.org/embed/gg_Gear_Stadium_1991NamcoJP", category: "namco" },
            { name: "Namco Museum", url: "https://archive.org/embed/namco_n64", category: "namco" },
            { name: "Pacman 2", url: "https://archive.org/embed/pacman_snes_2", category: "namco" },
            { name: "Ms Pacman Maze Madness", url: "https://archive.org/embed/psx_mspacmma", category: "namco" },
            { name: "Aqua rush", url: "https://archive.org/embed/arcade_aquarush", category: "namco" },
            { name: "Fighter & Attacker US", url: "https://archive.org/embed/arcade_fghtatck", category: "namco" },
            { name: "Knuckle Heads", url: "https://archive.org/embed/arcade_knckhead", category: "namco" },
            { name: "Pocket Racer Japan", url: "https://archive.org/embed/arcade_pocketrc", category: "namco" },
            { name: "Point Blank 2", url: "https://archive.org/embed/arcade_ptblank2", category: "namco" },
            { name: "Quester Japan", url: "https://archive.org/embed/arcade_quester", category: "namco" },
            { name: "Super World Stadium '98", url: "https://archive.org/embed/arcade_sws98", category: "namco" },
            { name: "Tekken battle Scratch", url: "https://archive.org/embed/arcade_tekkenbs", category: "namco" },
            { name: "Ms. Pacman (Gameboy)", url: "https://archive.org/embed/mspacman_gb_2", category: "namco" },
            { name: "Wrestleball", url: "https://archive.org/embed/sg_Wrestleball_1991_Namco_JP_en", category: "namco" },
            { name: "Pac Attack", url: "https://archive.org/embed/gg_Pac-Attack_1994Namco", category: "namco" },

            // Other Games
            { name: "Boulder Dash", url: "https://archive.org/embed/arcade_bouldash", category: "other" },
            { name: "Dragon's Lair", url: "https://archive.org/embed/arcade_dlair", category: "other" },
            { name: "Felix the Cat", url: "https://archive.org/embed/arcade_felix", category: "other" },
            { name: "Pac-Man", url: "https://archive.org/embed/arcade_pacman", category: "other" },
            { name: "Popeye", url: "https://archive.org/embed/arcade_popeye", category: "other" },
            { name: "Qix", url: "https://archive.org/embed/arcade_qix", category: "other" },
            { name: "Spider-Man", url: "https://archive.org/embed/arcade_spidman", category: "other" },
            { name: "Worms Armageddon", url: "https://archive.org/embed/psx_wormsarm", category: "other" },
            { name: "Cannon fodder", url: "https://archive.org/embed/Cannon_Fodder_E_p1", category: "other" }
        ];

        // Theme definitions
        const themes = {
            default: {
                primaryColor: "#4ecdc4",
                secondaryColor: "#ff6b6b",
                backgroundColor: "#1a1a2e",
                backgroundGradient: "linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",
                cardBg: "rgba(255, 255, 255, 0.1)",
                textColor: "#fff",
                accentColor: "#45b7d1",
                footerText: "#b8b8b8"
            },
            "nintendo-red": {
                primaryColor: "#e60012",
                secondaryColor: "#ffcb05",
                backgroundColor: "#8b0000",
                backgroundGradient: "linear-gradient(135deg, #8b0000 0%, #a30000 50%, #e60012 100%)",
                cardBg: "rgba(255, 255, 255, 0.1)",
                textColor: "#fff",
                accentColor: "#ffcb05",
                footerText: "#ffcb05"
            },
            "nintendo-blue": {
                primaryColor: "#0066cc",
                secondaryColor: "#ff9900",
                backgroundColor: "#003366",
                backgroundGradient: "linear-gradient(135deg, #003366 0%, #004c99 50%, #0066cc 100%)",
                cardBg: "rgba(255, 255, 255, 0.1)",
                textColor: "#fff",
                accentColor: "#ff9900",
                footerText: "#ff9900"
            },
            "gameboy": {
                primaryColor: "#0f380f",
                secondaryColor: "#306230",
                backgroundColor: "#0f380f",
                backgroundGradient: "linear-gradient(135deg, #0f380f 0%, #306230 50%, #8bac0f 100%)",
                cardBg: "rgba(143, 188, 15, 0.1)",
                textColor: "#9bbc0f",
                accentColor: "#8bac0f",
                footerText: "#8bac0f"
            },
            "dark-void": {
                primaryColor: "#6a0dad",
                secondaryColor: "#ff1493",
                backgroundColor: "#000000",
                backgroundGradient: "linear-gradient(135deg, #000000 0%, #2d004d 50%, #6a0dad 100%)",
                cardBg: "rgba(106, 13, 173, 0.1)",
                textColor: "#e6e6fa",
                accentColor: "#ff1493",
                footerText: "#e6e6fa"
            },
            "midnight": {
                primaryColor: "#1e90ff",
                secondaryColor: "#ff6b6b",
                backgroundColor: "#0a0a2a",
                backgroundGradient: "linear-gradient(135deg, #0a0a2a 0%, #1a1a4a 50%, #2a2a6a 100%)",
                cardBg: "rgba(30, 144, 255, 0.1)",
                textColor: "#f0f8ff",
                accentColor: "#ff6b6b",
                footerText: "#f0f8ff"
            },
            "sunshine": {
                primaryColor: "#ff8c00",
                secondaryColor: "#ff1493",
                backgroundColor: "#ffd700",
                backgroundGradient: "linear-gradient(135deg, #ffd700 0%, #ffa500 50%, #ff8c00 100%)",
                cardBg: "rgba(255, 255, 255, 0.3)",
                textColor: "#8b4513",
                accentColor: "#ff1493",
                footerText: "#8b4513"
            },
            "pastel-dream": {
                primaryColor: "#ffb6c1",
                secondaryColor: "#98fb98",
                backgroundColor: "#f0f8ff",
                backgroundGradient: "linear-gradient(135deg, #f0f8ff 0%, #e6e6fa 50%, #d8bfd8 100%)",
                cardBg: "rgba(255, 255, 255, 0.5)",
                textColor: "#696969",
                accentColor: "#98fb98",
                footerText: "#696969"
            },
            "sega-blue": {
                primaryColor: "#0033cc",
                secondaryColor: "#ff0000",
                backgroundColor: "#000066",
                backgroundGradient: "linear-gradient(135deg, #000066 0%, #0033cc 50%, #3366ff 100%)",
                cardBg: "rgba(255, 255, 255, 0.1)",
                textColor: "#fff",
                accentColor: "#ff0000",
                footerText: "#ff0000"
            },
            "playstation-purple": {
                primaryColor: "#003087",
                secondaryColor: "#ffffff",
                backgroundColor: "#5a2d81",
                backgroundGradient: "linear-gradient(135deg, #5a2d81 0%, #7b3fa3 50%, #9c5dc5 100%)",
                cardBg: "rgba(255, 255, 255, 0.1)",
                textColor: "#fff",
                accentColor: "#ffffff",
                footerText: "#ffffff"
            },
            "namco-yellow": {
                primaryColor: "#ffcc00",
                secondaryColor: "#ff3333",
                backgroundColor: "#663300",
                backgroundGradient: "linear-gradient(135deg, #663300 0%, #996600 50%, #ffcc00 100%)",
                cardBg: "rgba(255, 255, 255, 0.1)",
                textColor: "#fff",
                accentColor: "#ff3333",
                footerText: "#ffcc00"
            }
        };

        // Enhanced content filtering system
        const contentFilter = {
            // Bad words and phrases
            badWords: [
                'fuck', 'shit', 'asshole', 'bitch', 'damn', 'crap', 'dick', 'piss', 'bastard', 'cunt',
                'nigger', 'fag', 'retard', 'slut', 'whore', 'pussy', 'cock', 'dickhead', 'motherfucker',
                'bullshit', 'fucking', 'shitty', 'ass', 'bitchy', 'douchebag', 'faggot', 'nigga'
            ],
            
            // Bad statements and patterns
            badStatements: [
                /(kill|hurt|harm).*(yourself|myself|ourselves)/gi,
                /(hate|despise).*(you|people|everyone)/gi,
                /(stupid|idiot|moron).*(people|you|everyone)/gi,
                /(go to hell|burn in hell)/gi,
                /(i wish you were dead|i hope you die)/gi,
                /(shut up|shut the fuck up)/gi,
                /(nobody likes you|everyone hates you)/gi,
                /(you suck|you\'re worthless)/gi,
                /(kill all|hurt all).*(people|gamers|users)/gi
            ],
            
            // Suspicious patterns that might indicate trolling
            suspiciousPatterns: [
                /(spam|spamming)/gi,
                /(troll|trolling)/gi,
                /(flame|flaming)/gi,
                /(raid|raiding)/gi,
                /(hack|hacking)/gi,
                /(cheat|cheating)/gi
            ],
            
            // Check if text contains inappropriate content
            checkText: function(text) {
                const lowerText = text.toLowerCase();
                
                // Check for bad words
                if (this.badWords.some(word => lowerText.includes(word))) {
                    return { isInappropriate: true, reason: "Contains inappropriate language" };
                }
                
                // Check for bad statements
                if (this.badStatements.some(pattern => pattern.test(text))) {
                    return { isInappropriate: true, reason: "Contains harmful statements" };
                }
                
                // Check for suspicious patterns
                if (this.suspiciousPatterns.some(pattern => pattern.test(text))) {
                    return { isInappropriate: true, reason: "Contains suspicious content" };
                }
                
                // Check for excessive capitalization (shouting)
                const upperCaseRatio = (text.match(/[A-Z]/g) || []).length / text.length;
                if (upperCaseRatio > 0.7 && text.length > 10) {
                    return { isInappropriate: true, reason: "Please don't use excessive capitalization" };
                }
                
                // Check for excessive repetition
                const words = text.split(/\s+/);
                const uniqueWords = new Set(words);
                if (words.length > 5 && uniqueWords.size / words.length < 0.3) {
                    return { isInappropriate: true, reason: "Please avoid excessive repetition" };
                }
                
                return { isInappropriate: false, reason: "" };
            },
            
            // Filter text by replacing inappropriate content
            filterText: function(text) {
                let filteredText = text;
                
                // Replace bad words
                this.badWords.forEach(word => {
                    const regex = new RegExp(`\\b${word}\\b`, 'gi');
                    filteredText = filteredText.replace(regex, '*'.repeat(word.length));
                });
                
                return filteredText;
            }
        };

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize visitor counter
            initializeVisitorCounter();
            
            // Initialize active users counter
            initializeActiveUsers();
            
            // Display all games initially
            displayGames('all');
            
            // Set up category filter buttons
            document.querySelectorAll('.category-btn').forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons
                    document.querySelectorAll('.category-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Hide all sections
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Show selected section
                    const category = this.getAttribute('data-category');
                    document.getElementById(`section-${category}`).classList.add('active');
                    
                    // Display games for selected category
                    if (category !== 'suggestions') {
                        displayGames(category);
                    }
                });
            });
            
            // Set up search functionality
            document.getElementById('searchInput').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const activeCategory = document.querySelector('.category-btn.active').getAttribute('data-category');
                
                if (activeCategory === 'suggestions') {
                    return; // Don't filter suggestions section
                }
                
                filterGames(searchTerm, activeCategory);
            });
            
            // Set up theme selector
            document.getElementById('themeToggle').addEventListener('click', function() {
                document.getElementById('themeOptions').classList.toggle('active');
            });
            
            // Set up theme options
            document.querySelectorAll('.theme-option').forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme');
                    changeTheme(theme);
                    document.getElementById('themeOptions').classList.remove('active');
                });
            });
            
            // Set up random game picker
            document.getElementById('randomGameBtn').addEventListener('click', function() {
                pickRandomGame();
            });
            
            // Set up random game play button
            document.getElementById('randomGamePlay').addEventListener('click', function() {
                const gameName = document.getElementById('randomGameName').textContent;
                const game = games.find(g => g.name === gameName);
                if (game) {
                    openGameInViewer(game);
                }
            });
            
            // Set up suggestions form
            document.getElementById('suggestionForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const input = this.querySelector('.suggestions-input');
                const text = input.value.trim();
                
                if (text) {
                    const filterResult = contentFilter.checkText(text);
                    
                    if (filterResult.isInappropriate) {
                        showFilterWarning(filterResult.reason);
                        return;
                    }
                    
                    // If content is appropriate, proceed
                    addSuggestion(text);
                    input.value = '';
                    hideFilterWarning();
                }
            });
            
            // Update game counters
            updateGameCounters();
            
            // Load suggestions
            loadSuggestions();
            
            // Close theme options when clicking outside
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.theme-selector')) {
                    document.getElementById('themeOptions').classList.remove('active');
                }
            });

            // Game viewer close button
            document.getElementById('gameViewerClose').addEventListener('click', closeGameViewer);
            
            // Close game viewer when clicking outside
            document.getElementById('gameViewerModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeGameViewer();
                }
            });

            // Fullscreen functionality
            document.getElementById('fullscreenBtn').addEventListener('click', function() {
                const modal = document.getElementById('gameViewerModal');
                
                if (!document.fullscreenElement) {
                    // Enter fullscreen
                    if (modal.requestFullscreen) {
                        modal.requestFullscreen();
                    } else if (modal.webkitRequestFullscreen) {
                        modal.webkitRequestFullscreen();
                    } else if (modal.msRequestFullscreen) {
                        modal.msRequestFullscreen();
                    }
                    modal.classList.add('fullscreen');
                } else {
                    // Exit fullscreen
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.webkitExitFullscreen) {
                        document.webkitExitFullscreen();
                    } else if (document.msExitFullscreen) {
                        document.msExitFullscreen();
                    }
                    modal.classList.remove('fullscreen');
                }
            });

            // Reload game
            document.getElementById('reloadBtn').addEventListener('click', function() {
                const gameFrame = document.getElementById('gameFrame');
                gameFrame.src = gameFrame.src;
            });

            // Mute functionality (this will work for some embedded games)
            document.getElementById('muteBtn').addEventListener('click', function() {
                const gameFrame = document.getElementById('gameFrame');
                const btn = document.getElementById('muteBtn');
                
                // Try to mute the iframe (this may not work for all embedded content)
                try {
                    gameFrame.contentWindow.postMessage('{"event":"command","func":"mute","args":""}', '*');
                    btn.textContent = btn.textContent === '🔇' ? '🔊' : '🔇';
                } catch (e) {
                    console.log('Mute not supported for this game');
                }
            });

            // Handle fullscreen change events
            document.addEventListener('fullscreenchange', function() {
                const modal = document.getElementById('gameViewerModal');
                if (!document.fullscreenElement) {
                    modal.classList.remove('fullscreen');
                }
            });

            document.addEventListener('webkitfullscreenchange', function() {
                const modal = document.getElementById('gameViewerModal');
                if (!document.webkitFullscreenElement) {
                    modal.classList.remove('fullscreen');
                }
            });

            document.addEventListener('msfullscreenchange', function() {
                const modal = document.getElementById('gameViewerModal');
                if (!document.msFullscreenElement) {
                    modal.classList.remove('fullscreen');
                }
            });

            // Close game viewer with Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    if (document.getElementById('gameViewerModal').classList.contains('active')) {
                        closeGameViewer();
                    }
                }
            });
        });

        // Display games for a specific category (alphabetically sorted)
        function displayGames(category) {
            const gamesGrid = document.getElementById(`gamesGrid${category.charAt(0).toUpperCase() + category.slice(1)}`);
            gamesGrid.innerHTML = '';
            
            let filteredGames = category === 'all' ? games : games.filter(game => game.category === category);
            
            // Sort games alphabetically by name
            filteredGames = filteredGames.sort((a, b) => a.name.localeCompare(b.name));
            
            if (filteredGames.length === 0) {
                gamesGrid.innerHTML = '<div class="no-results">No games found in this category.</div>';
                return;
            }
            
            filteredGames.forEach(game => {
                const gameCard = document.createElement('div');
                gameCard.className = 'game-card';
                
                const gameButton = document.createElement('button');
                gameButton.className = 'game-button';
                gameButton.textContent = game.name;
                gameButton.addEventListener('click', function() {
                    openGameInViewer(game);
                });
                
                gameCard.appendChild(gameButton);
                gamesGrid.appendChild(gameCard);
            });
        }

        // Filter games based on search term and category (alphabetically sorted)
        function filterGames(searchTerm, category) {
            let gamesGrid;
            
            if (category === 'all') {
                gamesGrid = document.getElementById('gamesGridAll');
            } else {
                gamesGrid = document.getElementById(`gamesGrid${category.charAt(0).toUpperCase() + category.slice(1)}`);
            }
            
            gamesGrid.innerHTML = '';
            
            let filteredGames = category === 'all' 
                ? games.filter(game => game.name.toLowerCase().includes(searchTerm))
                : games.filter(game => game.category === category && game.name.toLowerCase().includes(searchTerm));
            
            // Sort games alphabetically by name
            filteredGames = filteredGames.sort((a, b) => a.name.localeCompare(b.name));
            
            if (filteredGames.length === 0) {
                gamesGrid.innerHTML = '<div class="no-results">No games found matching your search.</div>';
                return;
            }
            
            filteredGames.forEach(game => {
                const gameCard = document.createElement('div');
                gameCard.className = 'game-card';
                
                const gameButton = document.createElement('button');
                gameButton.className = 'game-button';
                gameButton.textContent = game.name;
                gameButton.addEventListener('click', function() {
                    openGameInViewer(game);
                });
                
                gameCard.appendChild(gameButton);
                gamesGrid.appendChild(gameCard);
            });
        }

        // Open game in embedded viewer - Full Screen
        function openGameInViewer(game) {
            document.getElementById('gameViewerTitle').textContent = game.name;
            const gameFrame = document.getElementById('gameFrame');
            
            // Set the iframe source
            gameFrame.src = game.url;
            
            // Show the modal
            const modal = document.getElementById('gameViewerModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden'; // Prevent scrolling
            
            // Focus the iframe for keyboard controls
            setTimeout(() => {
                gameFrame.focus();
            }, 100);
        }

        // Close game viewer
        function closeGameViewer() {
            const modal = document.getElementById('gameViewerModal');
            modal.classList.remove('active');
            modal.classList.remove('fullscreen');
            document.getElementById('gameFrame').src = '';
            document.body.style.overflow = ''; // Restore scrolling
            
            // Exit fullscreen if active
            if (document.fullscreenElement) {
                document.exitFullscreen();
            }
        }

        // Update game counters
        function updateGameCounters() {
            const totalGames = games.length;
            const nintendoGames = games.filter(game => game.category === 'nintendo').length;
            const segaGames = games.filter(game => game.category === 'sega').length;
            const capcomGames = games.filter(game => game.category === 'capcom').length;
            const namcoGames = games.filter(game => game.category === 'namco').length;
            const otherGames = games.filter(game => game.category === 'other').length;
            
            document.getElementById('totalGamesCounter').textContent = `${totalGames} Classic Games`;
            document.getElementById('all-counter').textContent = `${totalGames} Games`;
            document.getElementById('nintendo-counter').textContent = `${nintendoGames} Games`;
            document.getElementById('sega-counter').textContent = `${segaGames} Games`;
            document.getElementById('capcom-counter').textContent = `${capcomGames} Games`;
            document.getElementById('namco-counter').textContent = `${namcoGames} Games`;
            document.getElementById('other-counter').textContent = `${otherGames} Games`;
        }

        // Change theme function
        function changeTheme(themeName) {
            const theme = themes[themeName];
            
            document.documentElement.style.setProperty('--primary-color', theme.primaryColor);
            document.documentElement.style.setProperty('--secondary-color', theme.secondaryColor);
            document.documentElement.style.setProperty('--background-color', theme.backgroundColor);
            document.documentElement.style.setProperty('--background-gradient', theme.backgroundGradient);
            document.documentElement.style.setProperty('--card-bg', theme.cardBg);
            document.documentElement.style.setProperty('--text-color', theme.textColor);
            document.documentElement.style.setProperty('--accent-color', theme.accentColor);
            document.documentElement.style.setProperty('--footer-text', theme.footerText);
            
            // Save theme preference
            localStorage.setItem('selectedTheme', themeName);
        }

        // Random game picker
        function pickRandomGame() {
            const randomIndex = Math.floor(Math.random() * games.length);
            const randomGame = games[randomIndex];
            
            document.getElementById('randomGameName').textContent = randomGame.name;
            document.getElementById('randomResult').classList.add('active');
        }

        // Show filter warning
        function showFilterWarning(reason) {
            const warning = document.getElementById('filterWarning');
            warning.querySelector('p').textContent = reason;
            warning.classList.add('active');
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                hideFilterWarning();
            }, 5000);
        }

        // Hide filter warning
        function hideFilterWarning() {
            document.getElementById('filterWarning').classList.remove('active');
        }

        // Suggestions functionality
        function loadSuggestions() {
            const suggestions = JSON.parse(localStorage.getItem('gameSuggestions')) || [];
            const suggestionsList = document.getElementById('suggestionsList');
            suggestionsList.innerHTML = '';
            
            if (suggestions.length === 0) {
                suggestionsList.innerHTML = '<div class="no-results">No suggestions yet. Be the first to suggest a game!</div>';
                return;
            }
            
            suggestions.forEach((suggestion, index) => {
                const suggestionItem = document.createElement('div');
                suggestionItem.className = 'suggestion-item';
                suggestionItem.innerHTML = `
                    <div class="suggestion-text">${suggestion.text}</div>
                    <div class="suggestion-meta">
                        <span>Posted on ${new Date(suggestion.date).toLocaleDateString()}</span>
                        <span>${suggestion.replies ? suggestion.replies.length : 0} replies</span>
                    </div>
                    <div class="suggestion-reply">
                        <button class="reply-toggle" data-index="${index}">Reply</button>
                        <form class="reply-form" style="display: none;">
                            <input type="text" class="reply-input" placeholder="Write a reply..." required>
                            <button type="submit" class="reply-submit">Post</button>
                        </form>
                        ${suggestion.replies && suggestion.replies.length > 0 ? `
                            <div class="replies-list">
                                ${suggestion.replies.map(reply => `
                                    <div class="reply-item">
                                        <div>${reply.text}</div>
                                        <div class="suggestion-meta">Replied on ${new Date(reply.date).toLocaleDateString()}</div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
                suggestionsList.appendChild(suggestionItem);
            });
            
            // Add event listeners for reply toggles
            document.querySelectorAll('.reply-toggle').forEach(button => {
                button.addEventListener('click', function() {
                    const index = this.getAttribute('data-index');
                    const replyForm = this.nextElementSibling;
                    replyForm.style.display = replyForm.style.display === 'none' ? 'flex' : 'none';
                });
            });
            
            // Add event listeners for reply forms
            document.querySelectorAll('.reply-form').forEach(form => {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const input = this.querySelector('.reply-input');
                    const text = input.value.trim();
                    const index = this.previousElementSibling.getAttribute('data-index');
                    
                    if (text) {
                        const filterResult = contentFilter.checkText(text);
                        
                        if (filterResult.isInappropriate) {
                            showFilterWarning(filterResult.reason);
                            return;
                        }
                        
                        addReply(index, text);
                        input.value = '';
                        this.style.display = 'none';
                        hideFilterWarning();
                    }
                });
            });
        }

        function addSuggestion(text) {
            const suggestions = JSON.parse(localStorage.getItem('gameSuggestions')) || [];
            suggestions.unshift({
                text: text,
                date: new Date().toISOString(),
                replies: []
            });
            
            localStorage.setItem('gameSuggestions', JSON.stringify(suggestions));
            loadSuggestions();
        }

        function addReply(suggestionIndex, text) {
            const suggestions = JSON.parse(localStorage.getItem('gameSuggestions')) || [];
            if (suggestions[suggestionIndex]) {
                if (!suggestions[suggestionIndex].replies) {
                    suggestions[suggestionIndex].replies = [];
                }
                
                suggestions[suggestionIndex].replies.push({
                    text: text,
                    date: new Date().toISOString()
                });
                
                localStorage.setItem('gameSuggestions', JSON.stringify(suggestions));
                loadSuggestions();
            }
        }

        // Active Users Counter - Improved accuracy
        function initializeActiveUsers() {
            // Get active users from localStorage or initialize
            let activeUsers = JSON.parse(localStorage.getItem('activeUsers')) || {};
            const currentTime = Date.now();
            const userKey = 'user_' + Math.random().toString(36).substr(2, 9);
            
            // Add current user to active users
            activeUsers[userKey] = currentTime;
            
            // Remove users who haven't been active in the last 5 minutes
            Object.keys(activeUsers).forEach(key => {
                if (currentTime - activeUsers[key] > 5 * 60 * 1000) {
                    delete activeUsers[key];
                }
            });
            
            // Save updated active users
            localStorage.setItem('activeUsers', JSON.stringify(activeUsers));
            
            // Update display
            const activeCount = Object.keys(activeUsers).length;
            document.getElementById('activeUsersCount').textContent = activeCount;
            
            // Update every 30 seconds
            setInterval(() => {
                let activeUsers = JSON.parse(localStorage.getItem('activeUsers')) || {};
                const currentTime = Date.now();
                
                // Update current user's activity
                activeUsers[userKey] = currentTime;
                
                // Remove inactive users
                Object.keys(activeUsers).forEach(key => {
                    if (currentTime - activeUsers[key] > 5 * 60 * 1000) {
                        delete activeUsers[key];
                    }
                });
                
                // Save and update display
                localStorage.setItem('activeUsers', JSON.stringify(activeUsers));
                const activeCount = Object.keys(activeUsers).length;
                document.getElementById('activeUsersCount').textContent = activeCount;
            }, 30000);
        }

        // Visitor Counter System - Improved accuracy
        function initializeVisitorCounter() {
            // Get current date information
            const now = new Date();
            const today = now.toDateString();
            const weekStart = getWeekStart(now).toDateString();
            const monthStart = new Date(now.getFullYear(), now.getMonth(), 1).toDateString();
            const yearStart = new Date(now.getFullYear(), 0, 1).toDateString();
            
            // Get stored visitor data
            let visitorData = JSON.parse(localStorage.getItem('visitorData')) || {
                lastVisit: null,
                daily: { date: today, count: 0 },
                weekly: { date: weekStart, count: 0 },
                monthly: { date: monthStart, count: 0 },
                yearly: { date: yearStart, count: 0 }
            };
            
            // Check if we need to reset counters (new day, week, month, or year)
            if (visitorData.daily.date !== today) {
                visitorData.daily = { date: today, count: 0 };
            }
            
            if (visitorData.weekly.date !== weekStart) {
                visitorData.weekly = { date: weekStart, count: 0 };
            }
            
            if (visitorData.monthly.date !== monthStart) {
                visitorData.monthly = { date: monthStart, count: 0 };
            }
            
            if (visitorData.yearly.date !== yearStart) {
                visitorData.yearly = { date: yearStart, count: 0 };
            }
            
            // Check if this is a new visit (not a page refresh)
            const isNewVisit = visitorData.lastVisit !== today;
            
            if (isNewVisit) {
                // Increment all counters
                visitorData.daily.count++;
                visitorData.weekly.count++;
                visitorData.monthly.count++;
                visitorData.yearly.count++;
                visitorData.lastVisit = today;
                
                // Save updated data
                localStorage.setItem('visitorData', JSON.stringify(visitorData));
            }
            
            // Update display
            document.getElementById('dailyVisitors').textContent = visitorData.daily.count;
            document.getElementById('weeklyVisitors').textContent = visitorData.weekly.count;
            document.getElementById('monthlyVisitors').textContent = visitorData.monthly.count;
            document.getElementById('yearlyVisitors').textContent = visitorData.yearly.count;
            
            // Load saved theme
            const savedTheme = localStorage.getItem('selectedTheme') || 'default';
            changeTheme(savedTheme);
        }

        // Helper function to get the start of the week (Sunday)
        function getWeekStart(date) {
            const day = date.getDay();
            const diff = date.getDate() - day;
            return new Date(date.setDate(diff));
        }
    </script>
</body>
</html>